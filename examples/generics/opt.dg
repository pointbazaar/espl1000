
struct Opt<?T0> {
	?T0 value;
	bool present;
}

fn opt_set(Opt<?T0> o, ?T0 value) ~> bool {
	o.value   = value;
	o.present = true;
	return true;
}

fn opt_or_else(Opt<?T0> o, ?T0 value) ~> ?T0 {
	if o.present { return o.value; }
	return value;
}

fn main()~>int {

	Opt<int> opt = malloc(8*2);
	opt_set(opt, 3);
	
	printf("%d\n", opt.value);


	Opt<int> opt2 = malloc(8*2);
	opt2.present = false;
	printf("%d\n", opt_or_else(opt2, -1));

	return 0;
}
